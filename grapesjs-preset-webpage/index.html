<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>GrapesJS Preset Webpage</title>
  <link href="https://unpkg.com/grapesjs/dist/css/grapes.min.css" rel="stylesheet">
  <link href="dist/grapesjs-preset-webpage.min.css" rel="stylesheet">
  <script src="//feather.aviary.com/imaging/v3/editor.js"></script>
  <script src="https://static.filestackapi.com/v3/filestack-0.1.10.js"></script>
  <script src="https://unpkg.com/grapesjs"></script>
  <script src="dist/grapesjs-preset-webpage.min.js"></script>
  <style>
  body,
  html {
    height: 100%;
    margin: 0;
  }
  </style>
</head>
<body>

  <div id="gjs" style="height:0px; overflow:hidden">
    <div class="panel">
      <h1 class="welcome">Welcome to</h1>
      <div class="big-title">
        <svg class="logo" viewBox="0 0 100 100">
          <path d="M40 5l-12.9 7.4 -12.9 7.4c-1.4 0.8-2.7 2.3-3.7 3.9 -0.9 1.6-1.5 3.5-1.5 5.1v14.9 14.9c0 1.7 0.6 3.5 1.5 5.1 0.9 1.6 2.2 3.1 3.7 3.9l12.9 7.4 12.9 7.4c1.4 0.8 3.3 1.2 5.2 1.2 1.9 0 3.8-0.4 5.2-1.2l12.9-7.4 12.9-7.4c1.4-0.8 2.7-2.2 3.7-3.9 0.9-1.6 1.5-3.5 1.5-5.1v-14.9 -12.7c0-4.6-3.8-6-6.8-4.2l-28 16.2"/>
        </svg>
        <!-- <span>GrapesJS</span> -->
      </div>
      <!-- <div class="description">
      This is a demo content from index.html. For the development, you shouldn't edit this file, instead you can
      copy and rename it to _index.html, on next server start the new file will be served, and it will be ignored by git.
    </div> -->
  </div>
  <style>
  .panel {
    width: 90%;
    max-width: 700px;
    border-radius: 3px;
    padding: 30px 20px;
    margin: 150px auto 0px;
    background-color: #d983a6;
    box-shadow: 0px 3px 10px 0px rgba(0,0,0,0.25);
    color:rgba(255,255,255,0.75);
    font: caption;
    font-weight: 100;
  }

  .welcome {
    text-align: center;
    font-weight: 100;
    margin: 0px;
  }

  .logo {
    width: 70px;
    height: 70px;
    vertical-align: middle;
  }

  .logo path {
    pointer-events: none;
    fill: none;
    stroke-linecap: round;
    stroke-width: 7;
    stroke: #fff
  }

  .big-title {
    text-align: center;
    font-size: 3.5rem;
    margin: 15px 0;
  }

  .description {
    text-align: justify;
    font-size: 1rem;
    line-height: 1.5rem;
  }
  </style>
</div>


<script type="text/javascript">
var editor = grapesjs.init({
  height: '100%',
  showOffsets: 1,
  noticeOnUnload: 0,
  storageManager: { autoload: 0 },
  container: '#gjs',
  fromElement: true,

  plugins: ['gjs-preset-webpage'],
  pluginsOpts: {
    'gjs-preset-webpage': {},

  },
  commands: {
    defaults: [
      {
        // id and run are mandatory in this case
        id: 'my-command-id',
        run() {
          // alert('This is my command');
        },
      }, {
        id: '...',
        // ...
      }
    ],
  }
});
var blockManager = editor.BlockManager;


const commands = editor.Commands;
commands.add('my-command-id', editor => {
  // alert('This is my command');
});

// or it would be the same...
commands.add('my-command-id', {
  run(editor) {
    // alert('This is my command');
  },
});

editor.runCommand('my-command-id');

commands.add('my-command-state', {
  run(editor) {
    // alert('This command is now active');
  },
  stop(editor) {
    // alert('This command is disabled');
  },
});


// 'my-first-block' is the ID of the block
blockManager.add('my-first-block', {
  label: 'Simple block',
  content: '<div class="my-block">This is a simple block</div>',
});

blockManager.add('my-map-block', {
  label: 'Simple map block',
  content: {
    type: 'map', // Built-in 'map' component
    style: {
      height: '350px'
    },
    removable: false, // Once inserted it can't be removed
  }
})

blockManager.add('the-row-block', {
  label: '2 Columns',
  content: '<div class="row" data-gjs-droppable=".row-cell" data-gjs-custom-name="Row">' +
  '<div class="row-cell" data-gjs-draggable=".row">asdcansdas</div>' +
  '<div class="row-cell" data-gjs-draggable=".row">asdcansdas</div>' +
  '</div>',
});


blockManager.add('the-row-block', {
  // ...
  render: ({ el }) => {
    const btn = document.createElement('button');
    btn.innerHTML = 'Click me';
    btn.addEventListener('click', () => alert('Do something'))
    el.appendChild(btn);
  },
});

editor.on('run:my-command-modal', () => {
  console.log('After `my-command-modal` execution');
  // For example, you can add extra content to the modal
  const modalContent = editor.Modal.getContentEl();
  modalContent.insertAdjacentHTML('beforeEnd', '<div>Some content</div>');
});
editor.on('run:my-command-modal:before', () => {
  console.log('Before `my-command-modal` execution');
});
// for stateful commands
editor.on('stop:my-command-modal', () => {
  console.log('After `my-command-modal` is stopped');
});
editor.on('stop:my-command-modal:before', () => {
  console.log('Before `my-command-modal` is stopped');
});

editor.on('run', commandId => {
  console.log('Run', commandId);
});

editor.on('stop', commandId => {
  console.log('Stop', commandId);
});

// Append components directly to the canvas
let cmp = {
  tagName: 'div',
  components: [
    {
      type: 'image',
      attributes: { src: 'https://path/image' },
    }, {
      tagName: 'span',
      type: 'text',
      attributes: { title: 'foo' },
      components: [{
        type: 'textnode',
        content: 'Hello wdsforld!!!'
      }]
    }
  ]
}
editor.addComponents(cmp)[0];
const componentType = component.get('type'); // eg. 'image'

// or into some, already defined, component.
// For instance, appending to a selected component would be:
editor.getSelected().append(`<div>...`);

// Actually, editor.addComponents is an alias of...
editor.getWrapper().append(`<div>...`);

const { length } = component.components();
component.append('<div>...', { at: parseInt(length / 2, 10) })

// _______

const myNewComponentTypes = editor => {
  editor.DomComponents.addType('my-input-type', {
    // Make the editor understand when to bind `my-input-type`
    isComponent: el => el.tagName === 'INPUT',

    // Model definition
    model: {
      // Default properties
      defaults: {
        tagName: 'input',
        draggable: 'form, form *', // Can be dropped only inside `form` elements
        droppable: false, // Can't drop other elements inside
        attributes: { // Default attributes
          type: 'text',
          name: 'default-name',
          placeholder: 'Insert text here',
        },
        traits: [
          'name',
          'placeholder',
          { type: 'checkbox', name: 'required' },
        ],
      }
    }
  });};

editor = grapesjs.init({
  container : '#gjs',
  // ...
  plugins: [ myNewComponentTypes ],
});

function myPlugin(editor){
    editor.BlockManager.add('my-first-block', {
      label: 'Simple block',
      content: '<div class="my-block">This is a simple block</div>',
    });
}

var editor = grapesjs.init({
    container : '#gjs',
    plugins: [myPlugin]
});</script>
</body>
</html>
